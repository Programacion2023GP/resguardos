<div
  [ngClass]="{ 'bg-neutral-700': timeDay, 'bg-white': !timeDay }"
  class="flex flex-col w-screen h-full overflow-x-hidden"
>
  <!--
  NAVBAR SUPERION
-->

  <div class="flex w-full shadow-md z-40">
    <div class="w-full lg:w-screen h-fit">
      <nav
        class="relative flex items-center w-full overflow-auto p-4 bg-opacity-95"
      >
        <ul
          class="flex flex-row items-center w-full space-x-4 md:space-x-8 leading-10"
        >
          <!-- Logo -->
          <li>
            <img class="w-10 h-10" src="../../../assets/icon.png" alt="Logo" />
          </li>

          <!-- Button -->
          <li>
            <button
              class="p-2 rounded-full bg-purple-200 transition hover:bg-purple-300"
              (click)="toggleContent()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="30"
                height="30"
                fill="currentColor"
                viewBox="0 0 16 16"
                class="p-1 text-purple-800"
              >
                <path
                  fill-rule="evenodd"
                  d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"
                />
              </svg>
            </button>
          </li>

          <!-- Navigation Links Aligned to the Right -->
          <div class="flex-grow"></div>
          <!-- Fills space to push elements to the right -->

          <ng-container *ngIf="roleTypeUser < 3">
            <li
              class="cursor-pointer transition duration-200 hover:text-purple-800 border-b-2 border-transparent"
              [ngClass]="{
                'border-purple-500 text-purple-800': selectedUser[0]
              }"
              (click)="changeUserSelected(0)"
            >
              Todos
            </li>
          </ng-container>

          <ng-container *ngIf="roleTypeUser < 2">
            <li
              class="cursor-pointer transition duration-200 hover:text-purple-800 border-b-2 border-transparent"
              [ngClass]="{
                'border-purple-500 text-purple-800': selectedUser[1]
              }"
              (click)="changeUserSelected(1)"
            >
              Administradores
            </li>
          </ng-container>

          <ng-container *ngIf="roleTypeUser < 3">
            <li
              class="cursor-pointer transition duration-200 hover:text-purple-800 border-b-2 border-transparent"
              [ngClass]="{
                'border-purple-500 text-purple-800': selectedUser[2]
              }"
              (click)="changeUserSelected(2)"
            >
              Enlaces
            </li>
          </ng-container>

          <ng-container *ngIf="roleTypeUser < 3">
            <li
              class="cursor-pointer transition duration-200 hover:text-purple-800 border-b-2 border-transparent"
              [ngClass]="{
                'border-purple-500 text-purple-800': selectedUser[3]
              }"
              (click)="changeUserSelected(3)"
            >
              Empleados
            </li>
          </ng-container>

          <!-- Right aligned button -->
          <li (click)="changeTimeday()">
            <button class="text-2xl transition duration-200">
              <i
                class="fas"
                [ngClass]="{
                  'fa-sun text-yellow-400': timeDay,
                  'fa-moon text-gray-600': !timeDay
                }"
              ></i>
            </button>
          </li>
          <li (click)="changeOptions()">
            <button class="text-2xl transition duration-200">
              <i class="fas fa-user"></i>

            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <div *ngIf="optionsUser" class="absolute z-[500] top-12 right-4 mt-2 w-64 p-4 bg-white border border-gray-300 rounded-lg shadow-lg space-y-4">
    <!-- Título -->
    <p class="font-semibold text-gray-800 text-lg">Perfil</p>
    
    <!-- Contenedor de Cambio de Contraseña -->
    <div class="flex flex-col space-y-2 border-l-4 pl-4 border-purple-500">
      <p class="font-medium text-gray-600">Cambio de contraseña</p>
  
      <!-- Input de búsqueda -->
      <input
        (input)="changePassword($event)"
        type="password"
        [ngClass]="{ 'bg-white': !timeDay, 'bg-gray-200': timeDay }"
        class="pl-8 h-10 border border-gray-300 w-full rounded-md text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-purple-500"
        placeholder="Nueva contraseña"
      />
  
      <!-- Botón Cambiar Contraseña -->
      <button
      (click)="changePasswordSubmit()"
        class="w-full text-left p-2 bg-purple-500 text-white hover:bg-purple-600 focus:ring-2 focus:ring-purple-500 rounded-md font-medium transition duration-200"
      >
        Cambiar contraseña
      </button>
    </div>
    
    <!-- Opciones adicionales -->
    <div *ngIf="false" class="mt-2 text-sm text-gray-600">
      <p>Aquí puedes cambiar tu contraseña o realizar ajustes adicionales.</p>
    </div>
  </div>
  
  
  
  
  <!--
    NAVBAR SUPERION
  -->

  <div class="flex flex-row w-screen h-full">
    <!--
      SIDEBAR
    -->
    <!-- 
    <nav
      class="h-full  relative shadow-xl z-40 w-max-fit transition ease-in-out duration-100"
      [ngClass]="{
        ' md:w-3/12 h-20': isExpanded,
        'w-6': !isExpanded,
        'bg-neutral-700': timeDay,
        'bg-white': !timeDay
      }"
    >
      <ng-container *ngIf="isExpanded">
        <ul class="flex   h-full flex-col py-4 space-y-1 pl-3 pr-4">
          <ng-container *ngIf="roleTypeUser < 4">
            <li
              (click)="changeItemSelected(1)"
              [ngClass]="{
                'bg-purple-200 rounded-lg text-gray-800': selectedItemMenu[1]
              }"
            >
              <a
                [routerLink]="['/Usuarios']"
                class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
              >
                <span class="inline-flex justify-center items-center ml-4">
                  <i class="fas fa-users"></i>
                </span>
                <span class="ml-2 text-sm tracking-wide truncate"
                  >Usuarios</span
                >
              </a>
            </li>
          </ng-container>
          <ng-container *ngIf="roleTypeUser < 4">
            <li
              (click)="changeItemSelected(2)"
              [ngClass]="{
                'bg-purple-200 rounded-lg text-gray-800': selectedItemMenu[2]
              }"
            >
              <a
                [routerLink]="['/Resguardos']"
                class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
              >
                <span class="inline-flex justify-center items-center ml-4">
                  <i class="fas fa-lock"></i>
                </span>
                <span class="ml-2 text-sm tracking-wide truncate"
                  >Resguardos</span
                >
              </a>
            </li>
         
          </ng-container>
          <ng-container *ngIf="roleTypeUser < 3">
            <li
              (click)="changeItemSelected(3)"
              [ngClass]="{
                'bg-purple-200 rounded-lg text-gray-800': selectedItemMenu[3]
              }"
            >
              <a
                [routerLink]="['/TiposResguardos']"
                class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
              >
                <span class="inline-flex justify-center items-center ml-4">
                  <i class="fas fa-shield"></i>
                </span>
                <span class="ml-2 text-sm tracking-wide truncate"
                  >Catalogo Tipos/Resguardos</span
                >
              </a>
            </li>
            <li
              (click)="changeItemSelected(4)"
              [ngClass]="{
                'bg-purple-200 rounded-lg text-gray-800': selectedItemMenu[4]
              }"
            >
              <a
                [routerLink]="['/Estados']"
                class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
              >
                <span class="inline-flex justify-center items-center ml-4">
                  <i class="fas fa-shield"></i>
                </span>
                <span class="ml-2 text-sm tracking-wide truncate"
                  >Catalogo Estados/Resguardos</span
                >
              </a>
            </li>
            <li
            (click)="changeItemSelected(5)"
            [ngClass]="{
              'bg-purple-500 rounded-lg text-gray-800': selectedItemMenu[5]
            }"
          >
            <a
              [routerLink]="['/Graficas']"
              class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
            >
              <span class="inline-flex justify-center items-center ml-4">
<i class="fas fa-chart-bar"></i>
              </span>
              <span class="ml-2 text-sm tracking-wide truncate"
                >Graficas</span
              >
            </a>


            
          </li>
          <li
          (click)="changeItemSelected(6)"
          [ngClass]="{
            'bg-purple-500 rounded-lg text-gray-800': selectedItemMenu[5]
          }"
        >
      


        </li>
            <li
            (click)="changeItemSelected(7)"
            [ngClass]="{
              'bg-purple-200 rounded-lg text-gray-800': selectedItemMenu[6]
            }"
          >
            <a
              [routerLink]="['/Plantilla']"
              class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
            >
              <span class="inline-flex justify-center items-center ml-4">
                <i class="fas fa-camera"></i>
              </span>
              <span class="ml-2 text-sm tracking-wide truncate"
                >Plantilla de oficios</span
              >
            </a>
          </li>
          </ng-container>
          <li>

          <a
          [routerLink]="['/Korima']"
          class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
        >
          <span class="inline-flex justify-center items-center ml-4">
<i class="fas fa-chart-bar"></i>
          </span>
          <span class="ml-2 text-sm tracking-wide truncate"
            >Korima resguardos</span
          >
        </a>
      </li>
      <li>

        <a
        [routerLink]="['/Archivos']"
        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
      >
        <span class="inline-flex justify-center items-center ml-4">
<i class="fas fa-chart-bar"></i>
        </span>
        <span class="ml-2 text-sm tracking-wide truncate"
          >Oficios Korima</span
        >
      </a>
    </li>
    <li>

      <a
      [routerLink]="['/Archivos']"
      class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
    >
      <span class="inline-flex justify-center items-center ml-4">
<i class="fas fa-chart-bar"></i>
      </span>
      <span class="ml-2 text-sm tracking-wide truncate"
        >Autorizar bajas Korima</span
      >
    </a>
  </li>
      <li>

        <a
        [routerLink]="['/ResguardosUsuarios', nomina]"
        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
      >
        <span class="inline-flex justify-center items-center ml-4">
<i class="fas fa-chart-bar"></i>
        </span>
        <span class="ml-2 text-sm tracking-wide truncate"
          >resguardos control</span
        >
      </a>
    </li>
          <li>

            <a
              href="#"
              (click)="Logout()"
              class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-purple-50 hover:rounded-lg text-gray-600 hover:text-gray-800 border-l-4 border-transparent"
            >
              <span class="inline-flex justify-center items-center ml-4">
                <i class="fas fa-sign-out-alt"></i>
              </span>
              <span class="ml-2 text-sm tracking-wide truncate"
                >Cerrar Sesión</span
              >
            </a>
          </li>
        </ul>
      </ng-container>
    </nav> -->

    <nav
    class="px-3 relative h-screen shadow-2xl z-40 w-max-fit transition duration-150 ease-in-out truncate"
    [ngClass]="{
      'md:w-2/12 h-20': isExpanded,
      'w-6': !isExpanded,
      'bg-neutral-700 text-white': timeDay,
      'bg-white text-gray-700': !timeDay
    }"
  >
    <ng-container *ngFor="let item of menuItems">
      <!-- Título del menú principal -->
      <ng-container *ngIf="item.subItems.length > 0 && hasPermission(item.subItems)">
        <p
          class="bg-white rounded-md mt-2 w-full text-purple-900 shadow-lg p-3 cursor-pointer hover:bg-purple-200 text-md transition-all duration-300 transform hover:scale-105 flex items-center justify-between"
          (click)="toggleDropdown(item.title)"
        >
          <span>
            <i class="fas fa-folder"></i> {{ item.title }}
          </span>
          <i class="fas" [class.fa-angle-down]="item.title === openFolder" [class.fa-angle-right]="item.title !== openFolder"></i>
        </p>
  
        <!-- Dropdown de subitems -->
        <div *ngIf="item.title === openFolder" class="ml-4 mt-4 transition-all duration-300">
          <ul
            class="flex flex-col h-fit overflow-y-auto py-4 px-4 space-y-3 shadow-lg rounded-lg border-2 border-gray-300 bg-gray-50 hover:shadow-2xl transition-shadow duration-300"
          >
            <!-- Subitems del menú -->
            <ng-container *ngFor="let subItem of item.subItems">
              <li
                *ngIf="subItem?.permised && subItem?.permised?.includes(roleTypeUser)"
                (click)="changeItemSelected(subItem.name || '')"
                class="bg-purple-50 rounded-lg text-purple-800 shadow-sm transition-all duration-300 ease-in-out transform hover:bg-purple-200 hover:text-purple-900 hover:scale-105"
              >
                <a
                  [routerLink]="[subItem.link]"
                  class="relative flex items-center h-12 pl-4 pr-6 rounded-lg transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-purple-600 focus:ring-opacity-50"
                >
                  <span class="inline-flex items-center justify-center text-lg ml-3">
                    <i [class]="subItem.icon"></i>
                  </span>
                  <span class="ml-4 text-sm font-medium whitespace-normal">
                    {{ subItem.name }}
                  </span>
                </a>
              </li>
  
              <!-- Subitems anidados -->
              <ng-container *ngIf="subItem.subItems && subItem.subItems.length > 0 && hasPermission(subItem.subItems)">
                <span class="ml-4 text-sm font-medium whitespace-normal">
                  {{ subItem.title }}
                </span>
                <ul class="ml-4 pl-4 border-l-2 border-purple-300">
                  <ng-container *ngFor="let subSubItem of subItem.subItems">
                    <li
                      *ngIf="subSubItem?.permised && subSubItem?.permised?.includes(roleTypeUser)"
                      (click)="changeItemSelected(subSubItem.name || '')"
                      class="bg-purple-50 rounded-lg text-purple-800 shadow-sm transition-all duration-300 ease-in-out transform hover:bg-purple-200 hover:text-purple-900 hover:scale-105"
                    >
                      <a
                        [routerLink]="[subSubItem.link]"
                        class="relative flex items-center h-12 pl-4 pr-6 rounded-lg transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-purple-600 focus:ring-opacity-50"
                      >
                        <span class="inline-flex items-center justify-center text-lg ml-3">
                          <i [class]="subSubItem.icon"></i>
                        </span>
                        <span class="ml-4 text-sm font-medium whitespace-normal">
                          {{ subSubItem.name }}
                        </span>
                      </a>
                    </li>
                  </ng-container>
                </ul>
              </ng-container>
            </ng-container>
          </ul>
        </div>
      </ng-container>
    </ng-container>
  
    <!-- Cerrar sesión -->
    <p>
      <span
        (click)="Logout()"
        class="relative flex items-center h-12 pl-3 pr-4 rounded-md transition-colors duration-200 ease-in-out focus:outline-none hover:bg-red-100 hover:text-red-800 cursor-pointer"
      >
        <span class="inline-flex items-center justify-center text-lg ml-2">
          <i class="fas fa-sign-out-alt"></i>
        </span>
        <span class="ml-3 text-sm font-medium truncate">Cerrar Sesión</span>
      </span>
    </p>
  </nav>
  
  
  
  
  


    <!--
      OUTLET
    -->

    <div
      class="transition-colors duration-100 pb-10 max-sm:overflow-y-auto max-md:overflow-y-hidden"
      [ngClass]="{
        'md:w-10/12 h-20': isExpanded,
        'md:w-full': !isExpanded,
        'bg-neutral-700 border-none': timeDay,
        'bg-white': !timeDay
      }"
    >
      <div class="flex flex-row pb-40 mb-40 w-full h-full">
        <!-- Primera columna -->
        <div
          [ngClass]="{
        'max-w-[calc(100%-280px)]': isExpanded && roleTypeUser<4,
        'w-5/6':roleTypeUser<4,
        'w-full':roleTypeUser>4,

     
      }"
        >
          <!-- Ajuste del ancho máximo -->
          <div class="w-full h-full">
              <p class="text-2xl font-semibold w-full text-center text-gray-800  px-4 py-2  ">
                {{ selectedItem }}
              </p>
                        <router-outlet></router-outlet>
          </div>
        </div>

        <!-- Segunda columna (Cards) -->
        <ng-container *ngIf="roleTypeUser < 4">
          <div
            class="hidden sm:block lg:w-1/6 shadow-lg ml-2 overflow-auto h-screen flex-items"
          >
            <div
              [@repeatfadeInOutAnimation]="animationState"
              [ngClass]="{ 'border-r': !timeDay }"
              class="h-full overflow-hidden lg:block p-5"
            >
              <ng-container *ngIf="roleTypeUser < 4">
                <!-- Título -->
                <div class="text-xs text-gray-400 tracking-wider">
                   Usuarios
                </div>

                <!-- Barra de búsqueda -->
                <div class="relative mt-2">
                  <input
                    (input)="searchUser($event)"
                    type="text"
                    [ngClass]="{ 'bg-white': !timeDay, 'bg-gray-200': timeDay }"
                    class="pl-8 h-9 border border-gray-300  w-full rounded-md text-sm"
                    placeholder="N° Nomina | Nombre"
                  />
                  <svg
                    viewBox="0 0 24 24"
                    class="w-4 absolute text-gray-400 top-1/2 transform -translate-y-1/2 left-2"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg>
                </div>
              </ng-container>

              <!-- Contenedor de Cards -->
              <div
                class="pb-10 mt-3 custom-scrollbar max-w-full max-h-full overflow-y-auto"
              >
                <div class="mb-4 relative" *ngFor="let user of users; let index = index">
                  <!-- [routerLink]="['/ResguardosUsuarios', user.id]" -->
                  <button
                  (mouseenter)="zoomIn(user?.id)"
                  (mouseleave)="zoomOut(user?.id)"
                    [pTooltip]=" user.name"
                    [ngClass]="{
                      'bg-white shadow-md hover:shadow-lg transition-shadow duration-300 ':
                        !timeDay,
                      'bg-neutral-300': timeDay,
                      'border-2': true,
                      'border-blue-700': index === selected
                    }"
                    class="mb-4 p-4 w-full flex flex-col rounded-lg overflow-auto "
                    (click)="selectedEmployed(index)"
                  >
                    <!-- Perfil y nombre -->
                    <div
                      class="flex items-center pb-2 mb-2 border-b border-gray-200  w-full"
                    >
                      <li
                        class="fas fa-user text-blue-500 w-7 h-7 mr-3 rounded-full bg-gray-100 p-2"
                        alt="profile"
                      ></li>
                      <p
                        class="text-sm font-semibold text-gray-800 "
                      >
                        {{ user.name }}
                      </p>
                    </div>

                    <!-- Rol y nómina -->
                    <div class="flex items-center w-full space-x-2 mt-2">
                      <span
                        class="text-xs font-medium py-1 px-2 rounded-md"
                        [ngClass]="{
                          'bg-blue-100 text-blue-500': user.role === 2,
                          'bg-cyan-100 text-cyan-500': user.role === 3,
                          'bg-teal-100 text-teal-500': user.role === 4
                        }"
                      >
                        {{ user.type_role }}
                      </span>
                      <span class="ml-auto text-xs font-bold text-gray-600">{{
                        user.payroll
                      }}</span>
                    </div>
                    <div
                    *ngIf="user.id == idUserZoom"
                    class=" border absolute overflow-auto bg-white  p-2   z-50 bottom-0  left-0 right-20  w-fit h-fit"
                    >
                    <div class="flex flex-row  gap-2">
                      <button class="p-2 w-full bg-gray-100 rounded-lg shadow-sm hover:bg-gray-200" [routerLink]="['/ResguardosUsuarios', user.id]" >Control</button>
                      <button class="p-2 w-full bg-gray-100 rounded-lg shadow-sm hover:bg-gray-200"[routerLink]="['/Korima', user.payroll]" >Korima</button>
                    </div>
                    
                  </div>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>
